"use strict";(self.webpackChunkdeveloper_docs=self.webpackChunkdeveloper_docs||[]).push([[54924],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>y});var r=n(96540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),s=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=s(e.components);return r.createElement(c.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=s(n),g=a,y=d["".concat(c,".").concat(g)]||d[g]||u[g]||i;return n?r.createElement(y,o(o({ref:t},p),{},{components:n})):r.createElement(y,o({ref:t},p))}));function y(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=g;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[d]="string"==typeof e?e:a,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}g.displayName="MDXCreateElement"},27455:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var r=n(58168),a=(n(96540),n(15680));const i={id:"js-code-insertions",title:"Insert Custom JavaScript at Runtime",sidebar_label:"Insert JS at Runtime",description:"How to insert JavaScript code in your build from your C# scripts",keywords:["read","write","playable","luna","javascript","insert","inject","c# code"]},o=void 0,l={unversionedId:"playable/code/js-code-insertions",id:"playable/code/js-code-insertions",title:"Insert Custom JavaScript at Runtime",description:"How to insert JavaScript code in your build from your C# scripts",source:"@site/docs/playable/code/js-code-insertions.md",sourceDirName:"playable/code",slug:"/playable/code/js-code-insertions",permalink:"/docs/playable/code/js-code-insertions",draft:!1,tags:[],version:"current",frontMatter:{id:"js-code-insertions",title:"Insert Custom JavaScript at Runtime",sidebar_label:"Insert JS at Runtime",description:"How to insert JavaScript code in your build from your C# scripts",keywords:["read","write","playable","luna","javascript","insert","inject","c# code"]},sidebar:"gettingStarted",previous:{title:"Scripting Defines",permalink:"/docs/playable/code/scripting-defines"},next:{title:"JSON in Luna",permalink:"/docs/playable/code/json-in-luna"}},c={},s=[{value:"Custom Javascript Code in LunaPlaygroundField",id:"custom-javascript-code-in-lunaplaygroundfield",level:2},{value:"Call external JS via Bridge API",id:"call-external-js-via-bridge-api",level:2}],p={toc:s},d="wrapper";function u(e){let{components:t,...i}=e;return(0,a.yg)(d,(0,r.A)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("p",null,"This guide will show you how to inject JavaScript code at runtime into your creatives. As Luna uses Bridge.NET, you can easily call custom JavaScript functions from other libraries directly from your C# project through the Bridge API. The most common use case for this is to add additional HTML/JavaScript elements to enable network trackers."),(0,a.yg)("h2",{id:"custom-javascript-code-in-lunaplaygroundfield"},"Custom Javascript Code in LunaPlaygroundField"),(0,a.yg)("p",null,"You can use ",(0,a.yg)("inlineCode",{parentName:"p"},"Bridge.Script.Write()")," to insert custom JS at runtime."),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Let's create a new C# script, and attach it to a GameObject in the scene.")),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Initialise a public string and set it to be a JS function in string type, for example:"),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-cs"},'    public string codeMain = "console.log(\\"Test\\")";\n'))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Create an ",(0,a.yg)("inlineCode",{parentName:"p"},"Awake")," function where we'll call the Bridge API method ",(0,a.yg)("inlineCode",{parentName:"p"},"Write"),", and wrap it in a preprocessor directive (",(0,a.yg)("inlineCode",{parentName:"p"},"#if UNITY_LUNA"),") like in the following example:"),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-cs"},'    [ LunaPlaygroundField( "My Code", 0, "Additional Code" ) ]\n    public string codeMain = "console.log(\\"Test\\")";\n\n    private void Awake()\n    {\n#if UNITY_LUNA\n        Bridge.Script.Write( "let fn = Function(this.codeMain);" );\n        Bridge.Script.Write( "fn();" );\n#endif\n    }\n')),(0,a.yg)("p",{parentName:"li"},"As you can see, the argument in the ",(0,a.yg)("inlineCode",{parentName:"p"},"Write")," method is currently a string. This will then get converted and executed as JS code in the Luna build.")),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Create a Develop Build with the ",(0,a.yg)("a",{parentName:"p",href:"/docs/playable/code/luna-in-browser/dev-environment#enabling-and-disabling-the-dev-environment"},"Dev Environment activated"),"."),(0,a.yg)("p",{parentName:"li"},"The ",(0,a.yg)("inlineCode",{parentName:"p"},"codeMain")," variable is set as a ",(0,a.yg)("a",{parentName:"p",href:"/docs/playable/code/js-code-insertions"},(0,a.yg)("inlineCode",{parentName:"a"},"LunaPlaygroundField"))," and it will appear in the Dev Enviroment and ",(0,a.yg)("a",{parentName:"p",href:"/docs/playable/playground/create-playable"},"Creative Suite")," as the following:"))),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"images-small",src:n(56267).A,width:"852",height:"258"})),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"In this field, you can now write custom Javascript.\n\nIn this example, the custom code in the field is called when the playable starts (**`Test`** should get printed in the browser's console).\n")),(0,a.yg)("h2",{id:"call-external-js-via-bridge-api"},"Call external JS via Bridge API"),(0,a.yg)("p",null,"If you include ",(0,a.yg)("a",{parentName:"p",href:"/docs/playable/code/external-js-libraries"},"External JavaScript libraries")," into your project, you can use ",(0,a.yg)("inlineCode",{parentName:"p"},"Bridge.Script.Write()")," to execute their code. For example, if we add this simple JS script:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js"},"function printNumber(n) {\n  console.log(n);\n}\n")),(0,a.yg)("p",null,"as an external JavaScript library:"),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"images-large",src:n(32978).A,width:"1112",height:"860"})),(0,a.yg)("p",null,"You can then call the external library methods by using Bridge API:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-cs"},'    public string codeMain = "printNumber(5)"\n\n    private void Awake() {\n#if UNITY_LUNA\n        Bridge.Script.Write( "let fn = Function(this.codeMain);" );\n        Bridge.Script.Write( "fn();" );\n#endif\n    }\n')))}u.isMDXComponent=!0},32978:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/added-custom-js-d125dd451a0bcc7ed0717ff599075e50.png"},56267:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/custom-js-405f7cfb1c78de0f66aeb746efb93999.png"}}]);